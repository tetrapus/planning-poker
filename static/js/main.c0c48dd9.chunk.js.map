{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["uiConfig","signInFlow","callbacks","signInSuccessWithAuthResult","signInOptions","firebase","auth","GoogleAuthProvider","PROVIDER_ID","LoggedOutTemplate","style","marginTop","transform","flexGrow","margin","firebaseAuth","createGame","user","freestyle","a","firestore","runTransaction","transaction","game","collection","doc","set","owner","uid","name","displayName","activeTask","deck","created","Timestamp","now","id","window","location","search","CreateGameForm","useCollection","orderBy","limit","games","onClick","className","docs","map","data","toDate","toLocaleString","average","nums","length","reduce","b","ScoreState","members","scores","scoreData","revealed","display","flexDirection","fontSize","isMe","fontWeight","marginRight","Math","round","Object","values","filter","score","Game","useState","playerStatus","setPlayerStatus","overrideTask","setOverrideTask","gameDoc","slice","useDocument","gameLoading","tasks","tasksLoading","newTask","setNewTask","membersLoading","points","setPoints","ticket","setTicket","allScores","allScoresLoading","activeTaskId","find","task","taskIndex","findIndex","console","log","backgroundColor","textAlign","color","ref","merge","placeholder","onChange","event","value","onKeyPress","e","key","currentTarget","idx","document","phabricatorGetEpic","pattern","type","checkValidity","tickets","t","fields","background","height","padding","card","parseInt","marginBottom","disabled","phabricatorSetPoints","match","p","ticketId","minHeight","Interface","settingsDoc","settings","darkMode","position","right","bottom","App","useAuthState","gameId","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","initialised","initFirebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c0c48dd9.chunk.js","sourcesContent":["import \"./App.css\";\nimport firebase from \"firebase\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { useCollection, useDocument } from \"react-firebase-hooks/firestore\";\nimport { StyledFirebaseAuth } from \"react-firebaseui\";\nimport { useState } from \"react\";\n\n// Configure FirebaseUI.\nconst uiConfig = {\n  signInFlow: \"popup\",\n  callbacks: {\n    // Avoid redirects after sign-in.\n    signInSuccessWithAuthResult: () => false,\n  },\n  signInOptions: [firebase.auth.GoogleAuthProvider.PROVIDER_ID],\n};\n\nexport function LoggedOutTemplate() {\n  return (\n    <div\n      style={{\n        marginTop: \"50vh\",\n        transform: \"translateY(-100%)\",\n        flexGrow: 1,\n        margin: \"auto\",\n      }}\n    >\n      <h1>Planning Poker</h1>\n      <StyledFirebaseAuth uiConfig={uiConfig} firebaseAuth={firebase.auth()} />\n    </div>\n  );\n}\n\nasync function createGame(user, freestyle) {\n  const id = await firebase.firestore().runTransaction(async (transaction) => {\n    const game = firebase.firestore().collection(\"game\").doc();\n    await transaction.set(game, {\n      owner: user.uid,\n      name: `${user.displayName}'s Planning Poker`,\n      activeTask: null,\n      deck: freestyle ? null : [1, 2, 3, 5, 8, 13, 21],\n      created: firebase.firestore.Timestamp.now(),\n    });\n    await transaction.set(game.collection(\"members\").doc(user.uid), {\n      name: user.displayName,\n    });\n    return game.id;\n  });\n  window.location.search = id;\n}\n\nexport function CreateGameForm({ user }) {\n  const [games] = useCollection(\n    firebase.firestore().collection(\"game\").orderBy(\"created\", \"desc\").limit(10)\n  );\n  return (\n    <div style={{ margin: \"auto\" }}>\n      <h1>Welcome, {user.displayName}!</h1>\n      <button onClick={() => createGame(user, false)}>Start a new game</button>\n      <button className=\"Secondary\" onClick={() => createGame(user, true)}>\n        Freestyle\n      </button>\n      <h2>Join Game</h2>\n      <div>\n        {games\n          ? games.docs.map((game) => (\n              <div\n                onClick={() => (window.location.search = game.id)}\n                className=\"GameEntry\"\n              >\n                {game.data().name} (\n                {game.data().created.toDate().toLocaleString()})\n              </div>\n            ))\n          : null}\n      </div>\n    </div>\n  );\n}\n\nfunction average(nums) {\n  if (!nums.length) {\n    return 0;\n  }\n  return nums.reduce((a, b) => a + b) / nums.length;\n}\n\nfunction ScoreState({ game, user, activeTask, members, scores }) {\n  const scoreData = (scores ? scores.data() : null) || {};\n  const revealed = activeTask.data().revealed;\n  if (!members) {\n    return;\n  }\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        fontSize: \"18px\",\n      }}\n      className=\"Column\"\n    >\n      <div>\n        {members.docs.map((doc) => {\n          const isMe = user.uid === doc.id;\n          return (\n            <div\n              style={{\n                ...(isMe ? { fontWeight: \"bold\" } : {}),\n                ...{ margin: \"8px 12px\", display: \"flex\" },\n              }}\n            >\n              <div style={{ marginRight: \"auto\" }}>{doc.data().name} </div>\n              <div>\n                {isMe && scoreData\n                  ? scoreData[user.uid]\n                  : revealed\n                  ? scoreData[doc.id]\n                  : scoreData[doc.id]\n                  ? \"✔️\"\n                  : \"\"}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n      <div>\n        {revealed ? (\n          <>\n            Average:{\" \"}\n            {Math.round(\n              average(Object.values(scoreData).filter((score) => score !== \"?\"))\n            )}\n          </>\n        ) : (\n          <>\n            {Object.values(scoreData).length}/{members.docs.length} Responses\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function Game({ user }) {\n  const [playerStatus, setPlayerStatus] = useState(\"passive\"); // can be passive, active or paused\n  const [overrideTask, setOverrideTask] = useState(null);\n  const gameDoc = firebase\n    .firestore()\n    .collection(\"game\")\n    .doc(window.location.search.slice(1));\n  const [game, gameLoading] = useDocument(gameDoc);\n  const [tasks, tasksLoading] = useCollection(\n    gameDoc.collection(\"tasks\").orderBy(\"idx\")\n  );\n  const [newTask, setNewTask] = useState(\"\");\n  const [members, membersLoading] = useCollection(\n    gameDoc.collection(\"members\")\n  );\n  const [points, setPoints] = useState();\n  const [ticket, setTicket] = useState(\"\");\n  const [allScores, allScoresLoading] = useCollection(\n    gameDoc.collection(\"scores\")\n  );\n  if (gameLoading || tasksLoading || membersLoading) {\n    return null;\n  }\n  const activeTaskId = overrideTask ?? game.data().activeTask;\n  const activeTask =\n    activeTaskId && !tasksLoading\n      ? tasks.docs.find((task) => task.id === activeTaskId)\n      : null;\n  const scores = allScoresLoading\n    ? null\n    : allScores.docs.find((doc) => doc.id === activeTaskId);\n\n  const taskIndex = tasks.docs.findIndex((task) => task.id === activeTaskId);\n  console.log(ticket);\n  if (members.docs.find((doc) => doc.id === user.uid)) {\n    return (\n      <div\n        style={{ display: \"flex\", backgroundColor: \"#f0f0f0\" }}\n        className=\"Outer\"\n      >\n        <div style={{ textAlign: \"start\", margin: 8 }} className=\"Column\">\n          <h1>Tasks</h1>\n          <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n            {tasks\n              ? tasks.docs.map((doc) => (\n                  <div\n                    style={\n                      activeTaskId === doc.id\n                        ? { fontWeight: \"bold\" }\n                        : { color: \"grey\" }\n                    }\n                    onClick={() => {\n                      if (playerStatus === \"passive\") {\n                        return;\n                      }\n                      if (playerStatus === \"paused\") {\n                        setOverrideTask(doc.id);\n                        return;\n                      }\n\n                      firebase\n                        .firestore()\n                        .runTransaction(async (transaction) => {\n                          await transaction.set(\n                            game.ref,\n                            { activeTask: doc.id },\n                            { merge: true }\n                          );\n                        });\n                    }}\n                    className={\n                      playerStatus === \"passive\"\n                        ? \"TaskEntry TaskEntry-passive\"\n                        : \"TaskEntry\"\n                    }\n                  >\n                    {doc.data().name}\n                  </div>\n                ))\n              : null}\n            <input\n              placeholder=\"+ Add Task\"\n              onChange={(event) => setNewTask(event.value)}\n              value={newTask}\n              style={{ marginTop: 16 }}\n              onKeyPress={async (e) => {\n                if (e.key === \"Enter\") {\n                  const value = e.currentTarget.value;\n                  await firebase\n                    .firestore()\n                    .runTransaction(async (transaction) => {\n                      await transaction.set(gameDoc.collection(\"tasks\").doc(), {\n                        name: value,\n                        revealed: false,\n                        idx: tasks.docs.length,\n                      });\n                      setNewTask(\"\");\n                    });\n                }\n              }}\n            ></input>\n            {document.phabricatorGetEpic ? (\n              <input\n                placeholder=\"Ticket\"\n                value={ticket}\n                onChange={(e) => setTicket(e.currentTarget.value)}\n                pattern=\"T\\d+\"\n                type=\"text\"\n                onKeyPress={async (e) => {\n                  if (e.key === \"Enter\" && e.currentTarget.checkValidity()) {\n                    const tickets = await document.phabricatorGetEpic(ticket);\n                    let idx = tasks.docs.length;\n                    await firebase\n                      .firestore()\n                      .runTransaction(async (transaction) => {\n                        for (const t of tickets) {\n                          await transaction.set(\n                            gameDoc.collection(\"tasks\").doc(),\n                            {\n                              name: `T${t.id}: ${t.fields.name}`,\n                              revealed: false,\n                              idx: idx++,\n                            }\n                          );\n                        }\n                        setTicket(\"\");\n                      });\n                  }\n                }}\n              ></input>\n            ) : null}\n          </div>\n        </div>\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            background: \"white\",\n            height: \"auto\",\n          }}\n          className=\"Content\"\n        >\n          {activeTask ? (\n            <>\n              <h1 style={{ padding: \"38px\" }}>{activeTask.data().name}</h1>\n              <div style={{ margin: \"32px\" }}>\n                {game.data().deck ? (\n                  [...game.data().deck, \"?\"].map((card) => {\n                    return (\n                      <button\n                        className={`Card ${\n                          scores &&\n                          scores.data() &&\n                          card === scores.data()[user.uid]\n                            ? \"SelectedCard\"\n                            : \"\"\n                        }`}\n                        onClick={() => {\n                          firebase\n                            .firestore()\n                            .runTransaction(async (transaction) => {\n                              await transaction.set(\n                                game.ref.collection(\"scores\").doc(activeTaskId),\n                                {\n                                  [user.uid]: card,\n                                },\n                                { merge: true }\n                              );\n                            });\n                        }}\n                      >\n                        {card}\n                      </button>\n                    );\n                  })\n                ) : (\n                  <input\n                    placeholder=\"Score\"\n                    pattern=\"\\d+\"\n                    onKeyPress={async (e) => {\n                      if (\n                        e.key === \"Enter\" &&\n                        e.currentTarget.checkValidity()\n                      ) {\n                        const score = e.currentTarget.value;\n                        await firebase\n                          .firestore()\n                          .runTransaction(async (transaction) => {\n                            await transaction.set(\n                              game.ref.collection(\"scores\").doc(activeTaskId),\n                              {\n                                [user.uid]: parseInt(score),\n                              },\n                              { merge: true }\n                            );\n                          });\n                      }\n                    }}\n                  ></input>\n                )}\n              </div>\n              <div>\n                {playerStatus === \"passive\" ? (\n                  <div>\n                    You are voting.{\" \"}\n                    <span\n                      onClick={() => setPlayerStatus(\"active\")}\n                      className=\"Anchor\"\n                    >\n                      Take over the session\n                    </span>\n                  </div>\n                ) : (\n                  <div>\n                    <div style={{ marginBottom: \"16px\" }}>\n                      You are {playerStatus === \"paused\" ? \"not\" : \"\"}{\" \"}\n                      controlling the session.{\" \"}\n                      {playerStatus === \"active\" ? (\n                        <span\n                          onClick={() => {\n                            setPlayerStatus(\"paused\");\n                            setOverrideTask(null);\n                          }}\n                          className=\"Anchor\"\n                        >\n                          Pause\n                        </span>\n                      ) : (\n                        <span\n                          onClick={() => {\n                            setPlayerStatus(\"active\");\n                            setOverrideTask(null);\n                          }}\n                          className=\"Anchor\"\n                        >\n                          Resume\n                        </span>\n                      )}{\" \"}\n                      or{\" \"}\n                      <span\n                        onClick={() => {\n                          setPlayerStatus(\"passive\");\n                          setOverrideTask(null);\n                        }}\n                        className=\"Anchor\"\n                      >\n                        Abdicate\n                      </span>\n                    </div>\n                    {activeTask.data().revealed &&\n                    game.data().owner === user.uid ? (\n                      <div>\n                        <button\n                          onClick={() => {\n                            firebase\n                              .firestore()\n                              .runTransaction(async (transaction) => {\n                                await transaction.set(\n                                  activeTask.ref,\n                                  { revealed: false },\n                                  { merge: true }\n                                );\n                              });\n                          }}\n                          className=\"Secondary\"\n                        >\n                          Hide\n                        </button>\n                        <button\n                          disabled={taskIndex === tasks.docs.length - 1}\n                          onClick={() => {\n                            firebase\n                              .firestore()\n                              .runTransaction(async (transaction) => {\n                                await transaction.set(\n                                  game.ref,\n                                  { activeTask: tasks.docs[taskIndex + 1].id },\n                                  { merge: true }\n                                );\n                              });\n                          }}\n                        >\n                          Next\n                        </button>\n                      </div>\n                    ) : (\n                      <div>\n                        <button\n                          disabled={taskIndex === tasks.docs.length - 1}\n                          onClick={() => {\n                            firebase\n                              .firestore()\n                              .runTransaction(async (transaction) => {\n                                await transaction.set(\n                                  game.ref,\n                                  { activeTask: tasks.docs[taskIndex + 1].id },\n                                  { merge: true }\n                                );\n                              });\n                          }}\n                          className=\"Secondary\"\n                        >\n                          Skip\n                        </button>\n                        <button\n                          onClick={async () => {\n                            await firebase\n                              .firestore()\n                              .runTransaction(async (transaction) => {\n                                await transaction.set(\n                                  activeTask.ref,\n                                  { revealed: true },\n                                  { merge: true }\n                                );\n                              });\n                            setPoints(\n                              scores\n                                ? Math.round(\n                                    average(\n                                      Object.values(scores.data()).filter(\n                                        (score) => score !== \"?\"\n                                      )\n                                    )\n                                  )\n                                : 0\n                            );\n                          }}\n                        >\n                          Reveal\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                )}\n                {document.phabricatorSetPoints &&\n                activeTask &&\n                activeTask.data().name.match(/^T\\d+/) ? (\n                  <div style={{ marginTop: \"32px\" }}>\n                    <input\n                      placeholder=\"Points\"\n                      value={points}\n                      onChange={(e) => setPoints(e.currentTarget.value)}\n                    ></input>\n                    <button\n                      onClick={async () => {\n                        const p = parseInt(points);\n                        const ticketId = parseInt(\n                          activeTask.data().name.match(/^T(\\d+)/)[1]\n                        );\n                        await document.phabricatorSetPoints(ticketId, p);\n                        setPoints(\"\");\n                      }}\n                      className=\"InputButton\"\n                    >\n                      Set Points\n                    </button>\n                  </div>\n                ) : null}\n              </div>\n            </>\n          ) : (\n            <button\n              disabled={tasksLoading || !tasks.docs.length}\n              onClick={() => {\n                firebase.firestore().runTransaction(async (transaction) => {\n                  await transaction.set(\n                    game.ref,\n                    { activeTask: tasks.docs[0].id },\n                    { merge: true }\n                  );\n                });\n              }}\n            >\n              Start Game\n            </button>\n          )}\n        </div>\n        {activeTask ? (\n          <ScoreState\n            game={game}\n            user={user}\n            activeTask={activeTask}\n            members={membersLoading ? null : members}\n            scores={scores}\n          />\n        ) : null}\n      </div>\n    );\n  } else {\n    return (\n      <div\n        style={{\n          display: \"flex\",\n          minHeight: \"100vh\",\n        }}\n      >\n        <button\n          onClick={() => {\n            firebase.firestore().runTransaction(async (transaction) => {\n              await transaction.set(\n                gameDoc.collection(\"members\").doc(user.uid),\n                {\n                  name: user.displayName,\n                }\n              );\n            });\n          }}\n          style={{ transform: \"translateY(-100%)\", margin: \"auto\" }}\n        >\n          Join Session\n        </button>\n      </div>\n    );\n  }\n}\n\nfunction Interface({ id, user }) {\n  const settingsDoc = firebase.firestore().collection(\"settings\").doc(user.uid);\n  const [settings] = useCollection(settingsDoc);\n  const darkMode = settings?.data()?.darkMode;\n  return (\n    <div\n      style={{\n        ...(darkMode ? { filter: \"invert(0.95)\" } : {}),\n        ...{ display: \"flex\", flexGrow: 1, background: \"white\" },\n      }}\n    >\n      {id ? <Game id={id} user={user} /> : <CreateGameForm user={user} />}\n      <button\n        className=\"Secondary\"\n        style={{ position: \"absolute\", right: 0, bottom: 0, color: \"grey\" }}\n        onClick={() => {\n          firebase.firestore().runTransaction(async (transaction) => {\n            await transaction.set(\n              settingsDoc,\n              { darkMode: !darkMode },\n              { merge: true }\n            );\n          });\n        }}\n      >\n        {darkMode ? \"Light Mode\" : \"Dark Mode\"}\n      </button>\n    </div>\n  );\n}\n\nfunction App() {\n  const [user] = useAuthState(firebase.auth());\n  const gameId = window.location.search\n    ? window.location.search.slice(1)\n    : null;\n  return (\n    <div className=\"App\">\n      {user ? <Interface id={gameId} user={user} /> : <LoggedOutTemplate />}\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport firebase from \"firebase\";\n\nlet initialised = false;\n\nexport function initFirebase() {\n  if (initialised) {\n    return;\n  }\n  const firebaseConfig = {\n    apiKey: \"AIzaSyDd-g1pxYDd5wiI-8aRLKO7k0hpIA2ogO0\",\n    authDomain: \"planning-poker-27ef5.firebaseapp.com\",\n    databaseURL: \"https://planning-poker-27ef5.firebaseio.com\",\n    projectId: \"planning-poker-27ef5\",\n    storageBucket: \"planning-poker-27ef5.appspot.com\",\n    messagingSenderId: \"359210422354\",\n    appId: \"1:359210422354:web:32c9e1671ff01dddb68f8b\",\n  };\n\n  // Initialize Firebase\n  firebase.initializeApp(firebaseConfig);\n  initialised = true;\n}\n\ninitFirebase();\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}