(this["webpackJsonpplanning-poker"]=this["webpackJsonpplanning-poker"]||[]).push([[0],{34:function(e,t,n){},36:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t),n.d(t,"initFirebase",(function(){return A}));var c=n(5),a=n.n(c),r=n(23),i=n.n(r),s=(n(34),n(24)),o=n(29),d=n(25),l=n(11),u=n.n(l),j=n(12),b=n(16),h=(n(36),n(10)),f=n(26),p=n(17),O=n(27),v=n(3),m={signInFlow:"popup",callbacks:{signInSuccessWithAuthResult:function(){return!1}},signInOptions:[h.a.auth.GoogleAuthProvider.PROVIDER_ID]};function x(){return Object(v.jsx)("div",{css:{marginTop:"50vh",transform:"translateY(-50%)"},children:Object(v.jsx)(O.StyledFirebaseAuth,{uiConfig:m,firebaseAuth:h.a.auth()})})}function g(){return(g=Object(b.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.firestore().collection("game").add({owner:t.uid,name:"".concat(t.displayName,"'s Planning Poker"),activeTask:null,deck:[1,2,3,5,8,13,21],created:h.a.firestore.Timestamp.now()});case 2:(n=e.sent).collection("members").doc(t.uid).set({name:t.displayName}),window.location.search=n.id;case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){var t=e.user;return Object(v.jsxs)("div",{children:[Object(v.jsxs)("h1",{children:["Welcome, ",t.displayName,"!"]}),Object(v.jsx)("button",{onClick:function(){return function(e){return g.apply(this,arguments)}(t)},children:"Start a new game"})]})}function w(e){return e.length?e.reduce((function(e,t){return e+t}))/e.length:0}function y(e){e.game;var t=e.user,n=e.activeTask,c=e.members,a=e.scores,r=(a?a.data():null)||{},i=n.data().revealed;if(c)return Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"20vw"},children:[Object(v.jsx)("div",{children:c.docs.map((function(e){var n=t.uid===e.id;return Object(v.jsxs)("div",{style:n?{fontWeight:"bold"}:{},children:[e.data().name," ",n&&r?r[t.uid]:i?r[e.id]:r[e.id]?"\u2714\ufe0f":""]})}))}),Object(v.jsx)("div",{children:i?Object(v.jsxs)(v.Fragment,{children:["Average:"," ",Math.round(w(Object.values(r).filter((function(e){return"?"!==e}))))]}):Object(v.jsxs)(v.Fragment,{children:[Object.values(r).length,"/",c.docs.length," Responses"]})})]})}function T(e){var t=e.user,n=h.a.firestore().collection("game").doc(window.location.search.slice(1)),a=Object(p.b)(n),r=Object(j.a)(a,2),i=r[0],l=r[1],f=Object(p.a)(n.collection("tasks").orderBy("idx")),O=Object(j.a)(f,2),m=O[0],x=O[1],g=Object(c.useState)(""),k=Object(j.a)(g,2),T=k[0],C=k[1],I=Object(p.a)(n.collection("members")),S=Object(j.a)(I,2),A=S[0],P=S[1],F=Object(c.useState)(),D=Object(j.a)(F,2),N=D[0],R=D[1],E=Object(c.useState)(""),L=Object(j.a)(E,2),B=L[0],G=L[1],W=Object(p.a)(n.collection("scores").doc(null===i||void 0===i?void 0:i.data().activeTask)),J=Object(j.a)(W,1)[0];if(l||x||P)return null;var K=i.data().activeTask,M=K&&!x?m.docs.find((function(e){return e.id===K})):null,z=m.docs.findIndex((function(e){return e.id===K}));return console.log(B),A.docs.find((function(e){return e.id===t.uid}))?Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsxs)("div",{style:{width:"20vw"},children:[Object(v.jsx)("h1",{children:"Tasks"}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[m?m.docs.map((function(e){return Object(v.jsx)("div",{style:K===e.id?{fontWeight:"bold"}:{color:"grey"},onClick:function(){i.ref.set({activeTask:e.id},{merge:!0})},children:e.data().name})})):null,Object(v.jsx)("input",{placeholder:"+ Add Task",onChange:function(e){return C(e.value)},value:T,onKeyPress:function(){var e=Object(b.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=4;break}return e.next=3,n.collection("tasks").add({name:t.currentTarget.value,revealed:!1,idx:m.docs.length});case 3:C("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),document.phabricatorGetEpic?Object(v.jsxs)("div",{children:[Object(v.jsx)("input",{placeholder:"Ticket",value:B,onChange:function(e){return G(e.currentTarget.value)}}),Object(v.jsx)("button",{onClick:Object(b.a)(u.a.mark((function e(){var t,c,a,r,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(B),e.next=3,document.phabricatorGetEpic(B);case 3:t=e.sent,c=m.docs.length,a=Object(d.a)(t),e.prev=6,a.s();case 8:if((r=a.n()).done){e.next=14;break}return i=r.value,e.next=12,n.collection("tasks").add({name:"T".concat(i.id,": ").concat(i.fields.name),revealed:!1,idx:c++});case 12:e.next=8;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),a.e(e.t0);case 19:return e.prev=19,a.f(),e.finish(19);case 22:G("");case 23:case"end":return e.stop()}}),e,null,[[6,16,19,22]])}))),children:"Load Epic"})]}):null]})]}),Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column",width:"60vw"},children:M?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h1",{children:M.data().name}),Object(v.jsx)("div",{children:[].concat(Object(o.a)(i.data().deck),["?"]).map((function(e){return Object(v.jsx)("button",{className:"Card",onClick:function(){i.ref.collection("scores").doc(K).set(Object(s.a)({},t.uid,e),{merge:!0})},children:e})}))}),Object(v.jsxs)("div",{children:[M.data().revealed&&i.data().owner===t.uid?Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{onClick:function(){M.ref.set({revealed:!1},{merge:!0})},children:"Hide"}),Object(v.jsx)("button",{disabled:z===m.docs.length-1,onClick:function(){i.ref.set({activeTask:m.docs[z+1].id},{merge:!0})},children:"Next"})]}):Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{disabled:z===m.docs.length-1,onClick:function(){i.ref.set({activeTask:m.docs[z+1].id},{merge:!0})},children:"Skip"}),Object(v.jsx)("button",{onClick:function(){M.ref.set({revealed:!0},{merge:!0}),R(Math.round(w(Object.values(J.data()).filter((function(e){return"?"!==e})))))},children:"Reveal"})]}),document.phabricatorSetPoints&&M&&M.data().name.match(/^T\d+/)?Object(v.jsxs)("div",{children:[Object(v.jsx)("input",{placeholder:"Points",value:N,onChange:function(e){return R(e.currentTarget.value)}}),Object(v.jsx)("button",{onClick:Object(b.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(N),n=parseInt(M.data().name.match(/^T(\d+)/)[1]),e.next=4,document.phabricatorSetPoints(n,t);case 4:R("");case 5:case"end":return e.stop()}}),e)}))),children:"Set Points"})]}):null]})]}):Object(v.jsx)("button",{disabled:x||!m.docs.length,onClick:function(){return i.ref.set({activeTask:m.docs[0].id},{merge:!0})},children:"Start Game"})}),M?Object(v.jsx)(y,{game:i,user:t,activeTask:M,members:P?null:A,scores:J}):null]}):Object(v.jsx)("button",{onClick:function(){return n.collection("members").doc(t.uid).set({name:t.displayName})},children:"Join Session"})}var C=function(){var e=Object(f.a)(h.a.auth()),t=Object(j.a)(e,1)[0],n=window.location.search?window.location.search.slice(1):null;return Object(v.jsx)("div",{className:"App",children:Object(v.jsx)("header",{className:"App-header",children:t?n?Object(v.jsx)(T,{id:n,user:t}):Object(v.jsx)(k,{user:t}):Object(v.jsx)(x,{})})})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,52)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))},S=!1;function A(){if(!S){h.a.initializeApp({apiKey:"AIzaSyDd-g1pxYDd5wiI-8aRLKO7k0hpIA2ogO0",authDomain:"planning-poker-27ef5.firebaseapp.com",databaseURL:"https://planning-poker-27ef5.firebaseio.com",projectId:"planning-poker-27ef5",storageBucket:"planning-poker-27ef5.appspot.com",messagingSenderId:"359210422354",appId:"1:359210422354:web:32c9e1671ff01dddb68f8b"}),S=!0}}A(),i.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(C,{})}),document.getElementById("root")),I()}},[[51,1,2]]]);
//# sourceMappingURL=main.95238ae4.chunk.js.map